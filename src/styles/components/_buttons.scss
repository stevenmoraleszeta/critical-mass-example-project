// ============================================================================
// Button Component Styles
// Following Critical Mass requirements: BEM, Mobile-First, Accessibility
// Following project-idea.md: Button component specifications
// ============================================================================

// Import base files for variables and mixins
@use '../base/variables' as *;
@use '../base/mixins' as *;

// ============================================================================
// Button Block (BEM)
// Base styles for all buttons
// ============================================================================

.btn {
  // Base button styles
  display: inline-flex;
  align-items: center;
  justify-content: center;
  gap: var(--space-xs);
  
  // Typography - inherits monospace from body
  font-weight: var(--fw-medium);
  line-height: var(--lh-normal);
  text-align: center;
  text-decoration: none;
  
  // Layout
  border: none;
  border-radius: var(--radius-md);
  cursor: pointer;
  
  // Transitions
  @include transition-base(all);
  
  // Accessibility: Focus states
  // Always red focus for better visibility (20% thinner than before)
  outline: none;
  
  &:focus-visible {
    outline: var(--outline-width-focus) solid var(--color-secondary); // Red outline - always visible, 20% thinner
    outline-offset: var(--outline-offset-focus);
    border-radius: var(--radius-md);
  }
  
  &:focus:not(:focus-visible) {
    outline: none;
  }
  
  // Remove default button styles
  background: none;
  padding: 0;
  margin: 0;
  
  // Prevent text selection on buttons
  user-select: none;
  
  // Ensure buttons are accessible
  &:focus {
    outline: none;
  }
  
  // ============================================================================
  // Button Elements (BEM)
  // ============================================================================
  
  &__text {
    display: inline-flex;
    align-items: center;
    gap: var(--space-xs);
    
    // Inherit color from parent button by default
    // This allows variant styles to override when needed
    color: inherit;
    
    // Ensure SVG icons inherit color and align properly
    svg {
      width: 1.5em;
      height: 1.5em;
      flex-shrink: 0;
      color: inherit;
    }
  }
  
  &__spinner {
    display: inline-block;
    width: 1em;
    height: 1em;
    border: var(--border-width-base) solid currentColor;
    border-right-color: transparent;
    border-radius: 50%;
    animation: btn-spin 0.6s linear infinite;
  }
  
  // ============================================================================
  // Button Variants (BEM Modifiers)
  // Following project-idea.md: primary, secondary, ghost variants
  // ============================================================================
  
  // Primary Variant
  &--primary {
    background-color: var(--color-primary); // Blue base
    color: var(--color-white);
    
    // Ensure text element inherits white color
    .btn__text {
      color: var(--color-white);
    }
    
    &:hover:not(:disabled):not(.btn--disabled) {
      background-color: var(--color-primary); // Blue base - always same
      color: var(--color-white);
      
      .btn__text {
        color: var(--color-white);
      }
      
      transform: translateY(-1px);
      @include shadow-md;
    }
    
    &:active:not(:disabled):not(.btn--disabled) {
      background-color: var(--color-primary); // Blue base - always same
      color: var(--color-white);
      
      .btn__text {
        color: var(--color-white);
      }
      
      transform: translateY(0);
      @include shadow-sm;
    }
    
    // Focus state - Red outline (always visible, 20% thinner)
    &:focus-visible {
      outline: var(--outline-width-focus) solid var(--color-secondary); // Red outline
      outline-offset: var(--outline-offset-focus);
    }
  }
  
  // Secondary Variant
  &--secondary {
    background-color: var(--color-secondary); // Red base
    color: var(--color-white);
    
    // Ensure text element inherits white color
    .btn__text {
      color: var(--color-white);
    }
    
    &:hover:not(:disabled):not(.btn--disabled) {
      background-color: var(--color-secondary); // Red base - always same
      color: var(--color-white);
      
      .btn__text {
        color: var(--color-white);
      }
      
      transform: translateY(-1px);
      @include shadow-md;
    }
    
    &:active:not(:disabled):not(.btn--disabled) {
      color: var(--color-white);
      
      .btn__text {
        color: var(--color-white);
      }
      
      transform: translateY(0);
      @include shadow-sm;
    }
    
    // Focus state - Red outline (always visible, 20% thinner)
    &:focus-visible {
      outline: var(--outline-width-focus) solid var(--color-secondary); // Red outline
      outline-offset: var(--outline-offset-focus);
    }
  }
  
  // Ghost Variant
  &--ghost {
    background-color: transparent;
    color: var(--color-primary);
    border: var(--border-width-thin) solid var(--color-primary);
    
    &:hover:not(:disabled):not(.btn--disabled) {
      background-color: var(--color-primary);
      color: var(--color-bg-light);
      transform: translateY(-1px);
      @include shadow-md;
    }
    
    &:active:not(:disabled):not(.btn--disabled) {
      transform: translateY(0);
      @include shadow-sm;
    }
    
    // Focus state - Red outline (always visible, 20% thinner)
    &:focus-visible {
      outline: var(--outline-width-focus) solid var(--color-secondary); // Red outline
      outline-offset: var(--outline-offset-focus);
    }
  }
  
  // Save Variant - Yellow background with blue text
  &--save {
    background-color: var(--color-accent); // Yellow
    color: var(--color-primary); // Blue text
    border: var(--border-width-thin) solid var(--color-primary); // Blue border
    
    // Ensure text element is blue
    .btn__text {
      color: var(--color-primary); // Blue text
    }
    
    &:hover:not(:disabled):not(.btn--disabled) {
      background-color: var(--color-accent); // Stay yellow
      color: var(--color-primary); // Stay blue
      
      .btn__text {
        color: var(--color-primary); // Stay blue
      }
      
      transform: translateY(-1px);
      @include shadow-md;
    }
    
    &:active:not(:disabled):not(.btn--disabled) {
      background-color: var(--color-accent); // Stay yellow
      color: var(--color-primary); // Stay blue
      
      .btn__text {
        color: var(--color-primary); // Stay blue
      }
      
      transform: translateY(0);
      @include shadow-sm;
    }
    
    // Focus state - Red outline (always visible, 20% thinner)
    &:focus-visible {
      outline: var(--outline-width-focus) solid var(--color-secondary); // Red outline
      outline-offset: var(--outline-offset-focus);
    }
  }
  
  // Exit Variant - Red background with white text
  &--exit {
    background-color: var(--color-secondary); // Red
    color: var(--color-white); // White text
    
    // Ensure text element is white
    .btn__text {
      color: var(--color-white); // White text
    }
    
    &:hover:not(:disabled):not(.btn--disabled) {
      background-color: var(--color-secondary); // Stay red
      color: var(--color-white); // Stay white
      
      .btn__text {
        color: var(--color-white); // Stay white
      }
      
      transform: translateY(-1px);
      @include shadow-md;
    }
    
    &:active:not(:disabled):not(.btn--disabled) {
      background-color: var(--color-secondary); // Stay red
      color: var(--color-white); // Stay white
      
      .btn__text {
        color: var(--color-white); // Stay white
      }
      
      transform: translateY(0);
      @include shadow-sm;
    }
    
    // Focus state - Red outline (always visible, 20% thinner)
    &:focus-visible {
      outline: var(--outline-width-focus) solid var(--color-secondary); // Red outline
      outline-offset: var(--outline-offset-focus);
    }
  }
  
  // ============================================================================
  // Button Sizes (BEM Modifiers)
  // Following project-idea.md: sm, md, lg sizes
  // Mobile-first: base styles for mobile, enhance for larger screens
  // ============================================================================
  
  // Small Size
  &--sm {
    padding: var(--space-xs) var(--space-sm);
    font-size: var(--fs-sm);
    min-height: var(--button-min-height-sm);
    
    @include breakpoint-md {
      padding: var(--space-xs) var(--space-md);
      min-height: var(--button-min-height-sm-md);
    }
  }
  
  // Medium Size (default)
  &--md {
    padding: var(--space-sm) var(--space-md);
    font-size: var(--fs-base);
    min-height: var(--button-min-height-md);
    
    @include breakpoint-md {
      padding: var(--space-sm) var(--space-lg);
      min-height: var(--button-min-height-md-lg);
    }
  }
  
  // Large Size
  &--lg {
    padding: var(--space-md) var(--space-lg);
    font-size: var(--fs-lg);
    min-height: var(--button-min-height-lg);
    
    @include breakpoint-md {
      padding: var(--space-md) var(--space-xl);
      min-height: var(--button-min-height-lg-xl);
    }
  }
  
  // ============================================================================
  // Button States (BEM Modifiers)
  // ============================================================================
  
  // Disabled State
  // Yellow background with blue text
  &--disabled,
  &:disabled {
    background-color: var(--color-accent); // Yellow
    color: var(--color-primary); // Blue text
    border: var(--border-width-thin) solid var(--color-primary); // Blue border
    cursor: not-allowed;
    pointer-events: none;
    
    // Ensure text element is blue
    .btn__text {
      color: var(--color-primary); // Blue text
    }
    
    &:hover,
    &:active {
      transform: none;
      box-shadow: none;
      background-color: var(--color-accent); // Stay yellow
      color: var(--color-primary); // Stay blue
      
      .btn__text {
        color: var(--color-primary); // Stay blue
      }
    }
  }
  
  // Loading State
  // Yellow background with blue text
  &--loading {
    background-color: var(--color-accent); // Yellow
    color: var(--color-primary); // Blue text
    border: var(--border-width-thin) solid var(--color-primary); // Blue border
    cursor: wait;
    pointer-events: none;
    
    // Ensure text element is blue
    .btn__text {
      color: var(--color-primary); // Blue text
      opacity: 0.9; // Slightly reduced opacity but still visible
    }
    
    // Spinner should match blue text color
    .btn__spinner {
      border-color: var(--color-primary);
      border-right-color: transparent;
    }
  }
  
  // ============================================================================
  // Animations
  // ============================================================================
  
  @keyframes btn-spin {
    from {
      transform: rotate(0deg);
    }
    to {
      transform: rotate(360deg);
    }
  }
  
  // ============================================================================
  // Reduced Motion Support (Accessibility)
  // Following Critical Mass accessibility requirements
  // ============================================================================
  
  @media (prefers-reduced-motion: reduce) {
    &,
    &__spinner {
      animation: none;
      transition: none;
    }
    
    &:hover:not(:disabled):not(.btn--disabled) {
      transform: none;
    }
    
    &:active:not(:disabled):not(.btn--disabled) {
      transform: none;
    }
  }
}

// ============================================================================
// Responsive Enhancements (Mobile-First)
// Following Critical Mass requirement: Mobile-First approach
// ============================================================================

// Base styles are mobile-first (defined above)
// Additional responsive enhancements can be added here if needed


